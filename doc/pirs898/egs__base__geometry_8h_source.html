<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>EGSnrc C++ class library: /home/ftessier/EGSnrc/HEN_HOUSE/egs++/egs_base_geometry.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">EGSnrc C++ class library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<h1>/home/ftessier/EGSnrc/HEN_HOUSE/egs++/egs_base_geometry.h</h1>  </div>
</div>
<div class="contents">
<a href="egs__base__geometry_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">###############################################################################</span>
<a name="l00003"></a>00003 <span class="comment">#</span>
<a name="l00004"></a>00004 <span class="comment">#  EGSnrc egs++ base geometry headers</span>
<a name="l00005"></a>00005 <span class="comment">#  Copyright (C) 2015 National Research Council Canada</span>
<a name="l00006"></a>00006 <span class="comment">#</span>
<a name="l00007"></a>00007 <span class="comment">#  This file is part of EGSnrc.</span>
<a name="l00008"></a>00008 <span class="comment">#</span>
<a name="l00009"></a>00009 <span class="comment">#  EGSnrc is free software: you can redistribute it and/or modify it under</span>
<a name="l00010"></a>00010 <span class="comment">#  the terms of the GNU Affero General Public License as published by the</span>
<a name="l00011"></a>00011 <span class="comment">#  Free Software Foundation, either version 3 of the License, or (at your</span>
<a name="l00012"></a>00012 <span class="comment">#  option) any later version.</span>
<a name="l00013"></a>00013 <span class="comment">#</span>
<a name="l00014"></a>00014 <span class="comment">#  EGSnrc is distributed in the hope that it will be useful, but WITHOUT ANY</span>
<a name="l00015"></a>00015 <span class="comment">#  WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span>
<a name="l00016"></a>00016 <span class="comment">#  FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License for</span>
<a name="l00017"></a>00017 <span class="comment">#  more details.</span>
<a name="l00018"></a>00018 <span class="comment">#</span>
<a name="l00019"></a>00019 <span class="comment">#  You should have received a copy of the GNU Affero General Public License</span>
<a name="l00020"></a>00020 <span class="comment">#  along with EGSnrc. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00021"></a>00021 <span class="comment">#</span>
<a name="l00022"></a>00022 <span class="comment">###############################################################################</span>
<a name="l00023"></a>00023 <span class="comment">#</span>
<a name="l00024"></a>00024 <span class="comment">#  Author:          Iwan Kawrakow, 2005</span>
<a name="l00025"></a>00025 <span class="comment">#</span>
<a name="l00026"></a>00026 <span class="comment">#  Contributors:    Frederic Tessier</span>
<a name="l00027"></a>00027 <span class="comment">#                   Blake Walters</span>
<a name="l00028"></a>00028 <span class="comment">#</span>
<a name="l00029"></a>00029 <span class="comment">###############################################################################</span>
<a name="l00030"></a>00030 <span class="comment">*/</span>
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 
<a name="l00038"></a>00038 <span class="preprocessor">#ifndef EGS_BASE_GEOMETRY_</span>
<a name="l00039"></a>00039 <span class="preprocessor"></span><span class="preprocessor">#define EGS_BASE_GEOMETRY_</span>
<a name="l00040"></a>00040 <span class="preprocessor"></span>
<a name="l00041"></a>00041 <span class="preprocessor">#include &quot;<a class="code" href="egs__vector_8h.html" title="Provides methods for the manipulation of 3D vectors in cartesian co-ordinates.">egs_vector.h</a>&quot;</span>
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="keyword">using</span> std::string;
<a name="l00047"></a>00047 <span class="keyword">using</span> std::vector;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 <span class="keyword">class </span><a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a>;
<a name="l00050"></a>00050 <span class="keyword">struct </span><a class="code" href="structEGS__GeometryIntersections.html">EGS_GeometryIntersections</a>;
<a name="l00051"></a>00051 
<a name="l00052"></a>00052 <span class="preprocessor">#ifdef BPROPERTY64</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>    <span class="keyword">typedef</span> EGS_I64 EGS_BPType;
<a name="l00054"></a>00054 <span class="preprocessor">#elif defined BPROPERTY32</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>    <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> EGS_BPType;
<a name="l00056"></a>00056 <span class="preprocessor">#elif defined BPROPERTY16</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>    <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> EGS_BPType;
<a name="l00058"></a>00058 <span class="preprocessor">#else</span>
<a name="l00059"></a>00059 <span class="preprocessor"></span>    <span class="keyword">typedef</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> EGS_BPType;
<a name="l00060"></a>00060 <span class="preprocessor">#endif</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00081"></a><a class="code" href="classlabel.html">00081</a> <span class="keyword">class </span><a class="code" href="classlabel.html" title="Base geometry class. Every geometry class must be derived from EGS_BaseGeometry.">label</a> {
<a name="l00082"></a>00082 <span class="keyword">public</span>:
<a name="l00083"></a>00083     <span class="keywordtype">string</span>      name;
<a name="l00084"></a>00084     vector&lt;int&gt; regions;
<a name="l00085"></a>00085 };
<a name="l00086"></a>00086 
<a name="l00087"></a>00087 
<a name="l00088"></a><a class="code" href="classEGS__BaseGeometry.html">00088</a> <span class="keyword">class </span><a class="code" href="egs__libconfig_8h.html#ad29043faadac119821ed848d412e2c00" title="Export symbols from the egspp library.">EGS_EXPORT</a> <a class="code" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> {
<a name="l00089"></a>00089 
<a name="l00090"></a>00090 <span class="keyword">public</span>:
<a name="l00091"></a>00091 
<a name="l00097"></a>00097     <a class="code" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name);
<a name="l00098"></a>00098 
<a name="l00104"></a>00104     <span class="keyword">virtual</span> ~<a class="code" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a>();
<a name="l00105"></a>00105 
<a name="l00119"></a><a class="code" href="classEGS__BaseGeometry.html#ac5ab02600eeaf15cf76c732c8745f2d9">00119</a>     <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseGeometry.html#ac5ab02600eeaf15cf76c732c8745f2d9" title="Is the geometry convex?">isConvex</a>()<span class="keyword"> const </span>{
<a name="l00120"></a>00120         <span class="keywordflow">return</span> is_convex;
<a name="l00121"></a>00121     };
<a name="l00122"></a>00122 
<a name="l00128"></a>00128     <span class="keyword">virtual</span> <span class="keywordtype">int</span> inside(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;x) = 0;
<a name="l00129"></a>00129 
<a name="l00136"></a>00136     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> isInside(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;x) = 0;
<a name="l00137"></a>00137 
<a name="l00145"></a>00145     <span class="keyword">virtual</span> <span class="keywordtype">int</span> isWhere(<span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;x) = 0;
<a name="l00146"></a>00146 
<a name="l00155"></a><a class="code" href="classEGS__BaseGeometry.html#a399af80a14365f5196c33fe7b70aa875">00155</a>     <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#a399af80a14365f5196c33fe7b70aa875" title="Find the bin to which xp belongs, given np bin edges p.">findRegion</a>(EGS_Float xp, <span class="keywordtype">int</span> np, <span class="keyword">const</span> EGS_Float *p) {
<a name="l00156"></a>00156         <span class="keywordtype">int</span> ml = 0, mu = np;
<a name="l00157"></a>00157         <span class="keywordflow">while</span> (mu - ml &gt; 1) {
<a name="l00158"></a>00158             <span class="keywordtype">int</span> mav = (ml+mu)/2;
<a name="l00159"></a>00159             <span class="keywordflow">if</span> (xp &lt;= p[mav]) {
<a name="l00160"></a>00160                 mu = mav;
<a name="l00161"></a>00161             }
<a name="l00162"></a>00162             <span class="keywordflow">else</span> {
<a name="l00163"></a>00163                 ml = mav;
<a name="l00164"></a>00164             }
<a name="l00165"></a>00165         }
<a name="l00166"></a>00166         <span class="keywordflow">return</span>  mu - 1;
<a name="l00167"></a>00167     };
<a name="l00168"></a>00168 
<a name="l00199"></a>00199     <span class="keyword">virtual</span> <span class="keywordtype">int</span> howfar(<span class="keywordtype">int</span> ireg, <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;x, <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u,
<a name="l00200"></a>00200                        EGS_Float &amp;t, <span class="keywordtype">int</span> *newmed=0, <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> *normal=0) = 0;
<a name="l00201"></a>00201 
<a name="l00214"></a>00214     <span class="keyword">virtual</span> EGS_Float howfarToOutside(<span class="keywordtype">int</span> ireg, <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;x,
<a name="l00215"></a>00215                                       <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u);
<a name="l00216"></a>00216 
<a name="l00227"></a>00227     <span class="keyword">virtual</span> EGS_Float hownear(<span class="keywordtype">int</span> ireg, <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;x) = 0;
<a name="l00228"></a>00228 
<a name="l00233"></a><a class="code" href="classEGS__BaseGeometry.html#a4282471032a86bd0dbad1ccb994399b5">00233</a>     <span class="keyword">virtual</span> EGS_Float <a class="code" href="classEGS__BaseGeometry.html#a4282471032a86bd0dbad1ccb994399b5" title="Calculates the volume*relative rho (rhor) of region ireg.">getMass</a>(<span class="keywordtype">int</span> ireg) {
<a name="l00234"></a>00234         <span class="keywordflow">return</span> 1.0;
<a name="l00235"></a>00235     }
<a name="l00236"></a>00236 
<a name="l00242"></a><a class="code" href="classEGS__BaseGeometry.html#abeb4b60a8eb162592b22970ec676a34e">00242</a>     <span class="keyword">virtual</span> EGS_Float <a class="code" href="classEGS__BaseGeometry.html#abeb4b60a8eb162592b22970ec676a34e" title="Returns region boundaries in direction determined by idir.">getBound</a>(<span class="keywordtype">int</span> idir, <span class="keywordtype">int</span> ind) {
<a name="l00243"></a>00243         <span class="keywordflow">return</span> 0.0;
<a name="l00244"></a>00244     }
<a name="l00245"></a>00245 
<a name="l00251"></a><a class="code" href="classEGS__BaseGeometry.html#aa1a748c8520d94038cb4743010629826">00251</a>     <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#aa1a748c8520d94038cb4743010629826">getNRegDir</a>(<span class="keywordtype">int</span> idir) {
<a name="l00252"></a>00252         <span class="keywordflow">return</span> 0;
<a name="l00253"></a>00253     }
<a name="l00254"></a>00254 
<a name="l00261"></a><a class="code" href="classEGS__BaseGeometry.html#a46c4d27e3c6ca8f8392381c6b4f06df5">00261</a>     <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#a46c4d27e3c6ca8f8392381c6b4f06df5" title="Returns the number of local regions in this geometry.">regions</a>()<span class="keyword"> const </span>{
<a name="l00262"></a>00262         <span class="keywordflow">return</span> nreg;
<a name="l00263"></a>00263     };
<a name="l00264"></a>00264 
<a name="l00272"></a><a class="code" href="classEGS__BaseGeometry.html#a416edf220830ad6e4fd21cf45dcdebb5">00272</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseGeometry.html#a416edf220830ad6e4fd21cf45dcdebb5" title="Returnes true if ireg is a real region, false otherwise.">isRealRegion</a>(<span class="keywordtype">int</span> ireg)<span class="keyword"> const </span>{
<a name="l00273"></a>00273         <span class="keywordflow">return</span> (ireg &gt;= 0 &amp;&amp; ireg &lt; nreg);
<a name="l00274"></a>00274     };
<a name="l00275"></a>00275 
<a name="l00282"></a><a class="code" href="classEGS__BaseGeometry.html#aeae04119c0fa7a94b41627460878bd24">00282</a>     <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#aeae04119c0fa7a94b41627460878bd24" title="Returns the medium index in region ireg.">medium</a>(<span class="keywordtype">int</span> ireg)<span class="keyword"> const </span>{
<a name="l00283"></a>00283         <span class="keywordflow">return</span> region_media ? region_media[ireg] : med;
<a name="l00284"></a>00284     };
<a name="l00285"></a>00285 
<a name="l00291"></a><a class="code" href="classEGS__BaseGeometry.html#a8bc9aebe58a23ed3b6d9f2d4c72265fa">00291</a>     <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#a8bc9aebe58a23ed3b6d9f2d4c72265fa" title="Returns the maximum number of steps through the geometry.">getMaxStep</a>()<span class="keyword"> const </span>{
<a name="l00292"></a>00292         <span class="keywordflow">return</span> nreg+1;
<a name="l00293"></a>00293     };
<a name="l00294"></a>00294 
<a name="l00307"></a>00307     <span class="keyword">virtual</span> <span class="keywordtype">int</span> computeIntersections(<span class="keywordtype">int</span> ireg, <span class="keywordtype">int</span> n, <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;x,
<a name="l00308"></a>00308                                      <span class="keyword">const</span> <a class="code" href="classEGS__Vector.html" title="A class representing 3D vectors.">EGS_Vector</a> &amp;u, <a class="code" href="structEGS__GeometryIntersections.html">EGS_GeometryIntersections</a> *isections);
<a name="l00309"></a>00309 
<a name="l00319"></a>00319     <span class="keywordtype">void</span> setMedium(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name);
<a name="l00320"></a>00320 
<a name="l00328"></a>00328     <span class="keywordtype">void</span> setMedium(<span class="keywordtype">int</span> start, <span class="keywordtype">int</span> end, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name, <span class="keywordtype">int</span> delta=1);
<a name="l00329"></a>00329 
<a name="l00334"></a><a class="code" href="classEGS__BaseGeometry.html#ab028771512991d9a901c7cd359f7b531">00334</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__BaseGeometry.html#ab028771512991d9a901c7cd359f7b531" title="Set all regions to a medium with index imed.">setMedium</a>(<span class="keywordtype">int</span> imed) {
<a name="l00335"></a>00335         med = imed;
<a name="l00336"></a>00336     };
<a name="l00337"></a>00337 
<a name="l00345"></a>00345     <span class="keywordtype">void</span> setMedium(<span class="keywordtype">int</span> istart, <span class="keywordtype">int</span> iend, <span class="keywordtype">int</span> imed, <span class="keywordtype">int</span> delta=1);
<a name="l00346"></a>00346 
<a name="l00357"></a>00357     <span class="keywordtype">void</span> setMedia(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp);
<a name="l00358"></a>00358 
<a name="l00366"></a>00366     <span class="keyword">static</span> <span class="keywordtype">int</span> nMedia();
<a name="l00367"></a>00367 
<a name="l00373"></a>00373     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *getMediumName(<span class="keywordtype">int</span> ind);
<a name="l00374"></a>00374 
<a name="l00383"></a>00383     <span class="keyword">static</span> <span class="keywordtype">int</span> addMedium(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;medname);
<a name="l00384"></a>00384 
<a name="l00390"></a>00390     <span class="keyword">static</span> <span class="keywordtype">int</span> getMediumIndex(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;medname);
<a name="l00391"></a>00391 
<a name="l00395"></a><a class="code" href="classEGS__BaseGeometry.html#a219442f94535ac16c3a098b256d3a229">00395</a>     <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseGeometry.html#a219442f94535ac16c3a098b256d3a229" title="Does this geometry object have a mass density scaling feature?">hasRhoScaling</a>()<span class="keyword"> const </span>{
<a name="l00396"></a>00396         <span class="keywordflow">return</span> has_rho_scaling;
<a name="l00397"></a>00397     };
<a name="l00398"></a>00398 
<a name="l00402"></a><a class="code" href="classEGS__BaseGeometry.html#ae73ccf5d1d1264f3865b275a99ce1377">00402</a>     <span class="keyword">virtual</span> EGS_Float <a class="code" href="classEGS__BaseGeometry.html#ae73ccf5d1d1264f3865b275a99ce1377" title="Get the relative mass density in region ireg.">getRelativeRho</a>(<span class="keywordtype">int</span> ireg)<span class="keyword"> const </span>{
<a name="l00403"></a>00403         <span class="keywordflow">return</span> rhor &amp;&amp; ireg &gt;= 0 &amp;&amp; ireg &lt; nreg ? rhor[ireg] : 1;
<a name="l00404"></a>00404     };
<a name="l00405"></a>00405 
<a name="l00411"></a>00411     <span class="keyword">virtual</span> <span class="keywordtype">void</span> setRelativeRho(<span class="keywordtype">int</span> start, <span class="keywordtype">int</span> end, EGS_Float rho);
<a name="l00412"></a>00412 
<a name="l00422"></a>00422     <span class="keyword">virtual</span> <span class="keywordtype">void</span> setRelativeRho(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *);
<a name="l00423"></a>00423 
<a name="l00429"></a><a class="code" href="classEGS__BaseGeometry.html#a73cc8a7eaa7641e2abeac3bd47bc9e95">00429</a>     <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;<a class="code" href="classEGS__BaseGeometry.html#a73cc8a7eaa7641e2abeac3bd47bc9e95" title="Get the name of this geometry.">getName</a>()<span class="keyword"> const </span>{
<a name="l00430"></a>00430         <span class="keywordflow">return</span> name;
<a name="l00431"></a>00431     };
<a name="l00432"></a>00432 
<a name="l00439"></a>00439     <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;getType() <span class="keyword">const</span> = 0;
<a name="l00440"></a>00440 
<a name="l00459"></a>00459     <span class="keyword">static</span> <a class="code" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> *createGeometry(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *);
<a name="l00460"></a>00460 
<a name="l00477"></a>00477     <span class="keyword">static</span> <a class="code" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> *createSingleGeometry(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp);
<a name="l00478"></a>00478 
<a name="l00486"></a>00486     <span class="keyword">static</span> <span class="keywordtype">void</span> clearGeometries();
<a name="l00487"></a>00487 
<a name="l00493"></a><a class="code" href="classEGS__BaseGeometry.html#a56c0156478de143fd73a1f1cd2837a3a">00493</a>     <span class="keywordtype">void</span> <a class="code" href="classEGS__BaseGeometry.html#a56c0156478de143fd73a1f1cd2837a3a" title="Turn debugging on.">setDebug</a>(<span class="keywordtype">bool</span> deb) {
<a name="l00494"></a>00494         debug = deb;
<a name="l00495"></a>00495     };
<a name="l00496"></a>00496 
<a name="l00503"></a>00503     <span class="keyword">static</span> <a class="code" href="classEGS__BaseGeometry.html">EGS_BaseGeometry</a> *getGeometry(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;Name);
<a name="l00504"></a>00504 
<a name="l00511"></a>00511     <span class="keyword">static</span> <span class="keywordtype">string</span> getUniqueName();
<a name="l00512"></a>00512 
<a name="l00521"></a>00521     <span class="keywordtype">void</span>   setName(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp);
<a name="l00522"></a>00522 
<a name="l00525"></a><a class="code" href="classEGS__BaseGeometry.html#a0739a6f26ca1305a1b85a4fec0e0e80a">00525</a>     <span class="keyword">virtual</span> <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseGeometry.html#a0739a6f26ca1305a1b85a4fec0e0e80a" title="Is the boolean property prop set for region ireg ?">hasBooleanProperty</a>(<span class="keywordtype">int</span> ireg, EGS_BPType prop)<span class="keyword"> const </span>{
<a name="l00526"></a>00526         <span class="keywordflow">if</span> (!bp_array) {
<a name="l00527"></a>00527             <span class="keywordflow">return</span> (prop &amp; bproperty);
<a name="l00528"></a>00528         }
<a name="l00529"></a>00529         <span class="keywordflow">return</span> ireg &gt;= 0 &amp;&amp; ireg &lt; nreg ? prop &amp; bp_array[ireg] : <span class="keyword">false</span>;
<a name="l00530"></a>00530     };
<a name="l00531"></a>00531 
<a name="l00537"></a>00537     <span class="keyword">virtual</span> <span class="keywordtype">void</span> setBooleanProperty(EGS_BPType prop);
<a name="l00538"></a>00538 
<a name="l00546"></a>00546     <span class="keyword">virtual</span> <span class="keywordtype">void</span> addBooleanProperty(<span class="keywordtype">int</span> bit);
<a name="l00547"></a>00547 
<a name="l00554"></a>00554     <span class="keyword">virtual</span> <span class="keywordtype">void</span> setBooleanProperty(EGS_BPType prop, <span class="keywordtype">int</span> start, <span class="keywordtype">int</span> end,
<a name="l00555"></a>00555                                     <span class="keywordtype">int</span> step=1);
<a name="l00556"></a>00556 
<a name="l00563"></a>00563     <span class="keyword">virtual</span> <span class="keywordtype">void</span> addBooleanProperty(<span class="keywordtype">int</span> bit, <span class="keywordtype">int</span> start, <span class="keywordtype">int</span> end, <span class="keywordtype">int</span> step=1);
<a name="l00564"></a>00564 
<a name="l00575"></a>00575     <span class="keyword">virtual</span> <span class="keywordtype">void</span> printInfo() <span class="keyword">const</span>;
<a name="l00576"></a>00576 
<a name="l00582"></a>00582     <span class="keyword">static</span> <span class="keywordtype">void</span> describeGeometries();
<a name="l00583"></a>00583 
<a name="l00590"></a><a class="code" href="classEGS__BaseGeometry.html#ac8838b3734d0d63359ed0e401ea6b613">00590</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#ac8838b3734d0d63359ed0e401ea6b613" title="Increase the reference count to this geometry.">ref</a>() {
<a name="l00591"></a>00591         <span class="keywordflow">return</span> ++nref;
<a name="l00592"></a>00592     };
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 
<a name="l00602"></a><a class="code" href="classEGS__BaseGeometry.html#a15249dde8c0d7f0c07ff8c3050c15f05">00602</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#a15249dde8c0d7f0c07ff8c3050c15f05" title="Decrease the reference count to this geometry.">deref</a>() {
<a name="l00603"></a>00603         <span class="keywordflow">return</span> --nref;
<a name="l00604"></a>00604     };
<a name="l00605"></a>00605 
<a name="l00609"></a>00609     <span class="keyword">static</span> <span class="keywordtype">void</span> setActiveGeometryList(<span class="keywordtype">int</span> list);
<a name="l00610"></a>00610 
<a name="l00611"></a>00611     <span class="keyword">static</span> <span class="keywordtype">int</span> getLastError() {
<a name="l00612"></a>00612         <span class="keywordflow">return</span> error_flag;
<a name="l00613"></a>00613     };
<a name="l00614"></a>00614 
<a name="l00615"></a>00615     <span class="keyword">static</span> <span class="keywordtype">void</span> resetErrorFlag() {
<a name="l00616"></a>00616         error_flag = 0;
<a name="l00617"></a>00617     };
<a name="l00618"></a>00618 
<a name="l00619"></a>00619     <span class="keyword">static</span> <span class="keywordtype">void</span> setBoundaryTolerance(EGS_Float btol) {
<a name="l00620"></a>00620         epsilon = btol;
<a name="l00621"></a>00621     };
<a name="l00622"></a>00622 
<a name="l00623"></a>00623     <span class="keyword">static</span> EGS_Float getBoundaryTolerance() {
<a name="l00624"></a>00624         <span class="keywordflow">return</span> epsilon;
<a name="l00625"></a>00625     };
<a name="l00626"></a>00626 
<a name="l00628"></a>00628     <span class="keyword">virtual</span> <span class="keywordtype">void</span> getLabelRegions(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;str, vector&lt;int&gt; &amp;regs);
<a name="l00629"></a>00629 
<a name="l00631"></a><a class="code" href="classEGS__BaseGeometry.html#a992f85de0dd45504116ac77ec86e04b5">00631</a>     <span class="keyword">virtual</span> <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;<a class="code" href="classEGS__BaseGeometry.html#a992f85de0dd45504116ac77ec86e04b5" title="Get the name of the i-th explicit label in the geometry.">getLabelName</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> i) {
<a name="l00632"></a>00632         <span class="keywordflow">return</span> labels[i].name;
<a name="l00633"></a>00633     }
<a name="l00634"></a>00634 
<a name="l00636"></a><a class="code" href="classEGS__BaseGeometry.html#a0832de5ac094b106eb01d15f1ba0be8b">00636</a>     <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#a0832de5ac094b106eb01d15f1ba0be8b" title="Get the number of explicit labels in the geometry.">getLabelCount</a>() {
<a name="l00637"></a>00637         <span class="keywordflow">return</span> labels.size();
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639 
<a name="l00641"></a>00641     <span class="keywordtype">int</span> setLabels(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *input);
<a name="l00642"></a>00642 
<a name="l00644"></a>00644     <span class="keywordtype">int</span> setLabels(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;inp);
<a name="l00645"></a>00645 
<a name="l00646"></a>00646 <span class="keyword">protected</span>:
<a name="l00647"></a>00647 
<a name="l00653"></a><a class="code" href="classEGS__BaseGeometry.html#a4161f7a8587e80022798b1b242d70598">00653</a>     <span class="keywordtype">int</span>  <a class="code" href="classEGS__BaseGeometry.html#a4161f7a8587e80022798b1b242d70598" title="Number of local regions in this geometry.">nreg</a>;
<a name="l00654"></a>00654 
<a name="l00660"></a><a class="code" href="classEGS__BaseGeometry.html#ab8a2f2e0b08e86ab40f7922ddf28c8e5">00660</a>     <span class="keywordtype">string</span> <a class="code" href="classEGS__BaseGeometry.html#ab8a2f2e0b08e86ab40f7922ddf28c8e5" title="Name of this geometry.">name</a>;
<a name="l00661"></a>00661 
<a name="l00668"></a><a class="code" href="classEGS__BaseGeometry.html#a65dc1f1fb0df8d999a2a596424403157">00668</a>     <span class="keywordtype">short</span> *<a class="code" href="classEGS__BaseGeometry.html#a65dc1f1fb0df8d999a2a596424403157" title="Array of media indeces.">region_media</a>;
<a name="l00669"></a>00669 
<a name="l00676"></a><a class="code" href="classEGS__BaseGeometry.html#a9e25deca845a02cb0b7fae1eb06c00d9">00676</a>     <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#a9e25deca845a02cb0b7fae1eb06c00d9" title="Medium index.">med</a>;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678 
<a name="l00682"></a><a class="code" href="classEGS__BaseGeometry.html#a4c889bf8725991d462e3a0905c96f827">00682</a>     <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseGeometry.html#a4c889bf8725991d462e3a0905c96f827" title="Does this geometry have relative mass density scvaling?">has_rho_scaling</a>;
<a name="l00683"></a>00683 
<a name="l00687"></a><a class="code" href="classEGS__BaseGeometry.html#a892dcdf90c8385ce26f128e801c4c6f2">00687</a>     EGS_Float *<a class="code" href="classEGS__BaseGeometry.html#a892dcdf90c8385ce26f128e801c4c6f2" title="Array with relative mass densities.">rhor</a>;
<a name="l00688"></a>00688 
<a name="l00693"></a><a class="code" href="classEGS__BaseGeometry.html#a4779f1f8407f85adab1445c504f250d0">00693</a>     <span class="keywordtype">int</span> <a class="code" href="classEGS__BaseGeometry.html#a4779f1f8407f85adab1445c504f250d0" title="Number of references to this geometry.">nref</a>;
<a name="l00694"></a>00694 
<a name="l00703"></a>00703     <span class="keyword">virtual</span> <span class="keywordtype">void</span> setMedia(<a class="code" href="classEGS__Input.html" title="A class for storing information in a tree-like structure of key-value pairs. This class is used throu...">EGS_Input</a> *inp, <span class="keywordtype">int</span> nmed, <span class="keyword">const</span> <span class="keywordtype">int</span> *med_ind);
<a name="l00704"></a>00704 
<a name="l00709"></a><a class="code" href="classEGS__BaseGeometry.html#a23c3953ccef3523cff8c23f61b257103">00709</a>     <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseGeometry.html#a23c3953ccef3523cff8c23f61b257103" title="Debugging flag.">debug</a>;
<a name="l00710"></a>00710 
<a name="l00719"></a><a class="code" href="classEGS__BaseGeometry.html#a4c4a753cbb71ca1958bab4a3e453d221">00719</a>     <span class="keywordtype">bool</span> <a class="code" href="classEGS__BaseGeometry.html#a4c4a753cbb71ca1958bab4a3e453d221" title="Is this geometry convex?">is_convex</a>;
<a name="l00720"></a>00720 
<a name="l00725"></a><a class="code" href="classEGS__BaseGeometry.html#a1ad8280f370bfacac62aeecab99379a8">00725</a>     EGS_BPType   <a class="code" href="classEGS__BaseGeometry.html#a1ad8280f370bfacac62aeecab99379a8" title="A bit mask of boolean properties for the entire geometry.">bproperty</a>;
<a name="l00726"></a>00726 
<a name="l00732"></a><a class="code" href="classEGS__BaseGeometry.html#af4bdc0030dd30ecf107d05f0bb6aae05">00732</a>     EGS_BPType   *<a class="code" href="classEGS__BaseGeometry.html#af4bdc0030dd30ecf107d05f0bb6aae05" title="An array of boolean properties on a region by region basis.">bp_array</a>;
<a name="l00733"></a>00733 
<a name="l00735"></a><a class="code" href="classEGS__BaseGeometry.html#a0ff659ec439f1b6d11a5df517f2ca05c">00735</a>     <span class="keyword">static</span> EGS_Float <a class="code" href="classEGS__BaseGeometry.html#a0ff659ec439f1b6d11a5df517f2ca05c" title="Boundary tolerance for geometries that need it.">epsilon</a>;
<a name="l00736"></a>00736 
<a name="l00738"></a><a class="code" href="classEGS__BaseGeometry.html#ab76acb377c27803e0f226787cc8ddd04">00738</a>     <span class="keyword">static</span> <span class="keywordtype">int</span>       <a class="code" href="classEGS__BaseGeometry.html#ab76acb377c27803e0f226787cc8ddd04" title="Set to non-zero status if a geometry problem is encountered.">error_flag</a>;
<a name="l00739"></a>00739 
<a name="l00755"></a><a class="code" href="classEGS__BaseGeometry.html#ac0e2be5c15f789c3d96b8640fe782780">00755</a>     vector&lt;label&gt; <a class="code" href="classEGS__BaseGeometry.html#ac0e2be5c15f789c3d96b8640fe782780" title="Labels.">labels</a>;
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 <span class="keyword">private</span>:
<a name="l00758"></a>00758 
<a name="l00768"></a>00768     <span class="keyword">static</span> <span class="keywordtype">int</span> active_glist;
<a name="l00769"></a>00769 
<a name="l00770"></a>00770 };
<a name="l00771"></a>00771 
<a name="l00772"></a><a class="code" href="structEGS__GeometryIntersections.html">00772</a> <span class="keyword">struct </span><a class="code" href="structEGS__GeometryIntersections.html">EGS_GeometryIntersections</a> {
<a name="l00773"></a><a class="code" href="structEGS__GeometryIntersections.html#a2f67d52d07a1de3523f38f32a0c5f9fa">00773</a>     EGS_Float <a class="code" href="structEGS__GeometryIntersections.html#a2f67d52d07a1de3523f38f32a0c5f9fa" title="distance to next region boundary">t</a>;     
<a name="l00774"></a><a class="code" href="structEGS__GeometryIntersections.html#a7955eb5e61d33812a1585a94eccdee5f">00774</a>     EGS_Float <a class="code" href="structEGS__GeometryIntersections.html#a7955eb5e61d33812a1585a94eccdee5f" title="relative mass density in that region">rhof</a>;  
<a name="l00775"></a><a class="code" href="structEGS__GeometryIntersections.html#a2f1b6684410ebe0b1f621a7422f63236">00775</a>     EGS_I32   <a class="code" href="structEGS__GeometryIntersections.html#a2f1b6684410ebe0b1f621a7422f63236" title="region index">ireg</a>;  
<a name="l00776"></a><a class="code" href="structEGS__GeometryIntersections.html#ad6345c5ff2ddd6bf74b8d46a8d6cbc6f">00776</a>     EGS_I32   <a class="code" href="structEGS__GeometryIntersections.html#ad6345c5ff2ddd6bf74b8d46a8d6cbc6f" title="medium index">imed</a>;  
<a name="l00777"></a>00777 };
<a name="l00778"></a>00778 
<a name="l01024"></a>01024 <span class="comment">/* \example geometry/example1/geometry_example1.cpp</span>
<a name="l01025"></a>01025 <span class="comment"></span>
<a name="l01026"></a>01026 <span class="comment">  Suppose that you frequently use the same complex geometry and you</span>
<a name="l01027"></a>01027 <span class="comment">  are tired of always having to include the long definition of this geometry</span>
<a name="l01028"></a>01028 <span class="comment">  into your input file. In this case it may be worthwhile to implement your</span>
<a name="l01029"></a>01029 <span class="comment">  own geometry DSO that constructs the geometry of interest with very little</span>
<a name="l01030"></a>01030 <span class="comment">  input (or even no input at all). This example illustrates how to do this</span>
<a name="l01031"></a>01031 <span class="comment">  programatically.</span>
<a name="l01032"></a>01032 <span class="comment"></span>
<a name="l01033"></a>01033 <span class="comment">  As this is just an example, the geometry we will be constructing is not very</span>
<a name="l01034"></a>01034 <span class="comment">  complex: it consists of a cylinder inscribed in a sphere and the sphere</span>
<a name="l01035"></a>01035 <span class="comment">  inscribed in a box as shown in the figure ???. We want to be able to define</span>
<a name="l01036"></a>01036 <span class="comment">  the media of the cylinder, the sphere and the box in the input file</span>
<a name="l01037"></a>01037 <span class="comment">  (so that we can easily use different PEGS data sets, for example). All other</span>
<a name="l01038"></a>01038 <span class="comment">  dimensions of our example geometry are fixed.</span>
<a name="l01039"></a>01039 <span class="comment"></span>
<a name="l01040"></a>01040 <span class="comment">  To create our new geometry, we make a new subdirectory in the egspp</span>
<a name="l01041"></a>01041 <span class="comment">  geometries subdirectory called \c example1. To be able to use the</span>
<a name="l01042"></a>01042 <span class="comment">  predefined rules for building geometry libraries we create a dummy</span>
<a name="l01043"></a>01043 <span class="comment">  header file \c %geometry_example1.h that does nothing else except to</span>
<a name="l01044"></a>01044 <span class="comment">  define the \c EGS_EXAMPLE1_DLL</span>
<a name="l01045"></a>01045 <span class="comment">  macro:</span>
<a name="l01046"></a>01046 <span class="comment">  \include geometry/example1/geometry_example1.h</span>
<a name="l01047"></a>01047 <span class="comment">  and put the implementation in \c %geometry_example1.cpp.</span>
<a name="l01048"></a>01048 <span class="comment">  \dontinclude geometry/example1/geometry_example1.cpp</span>
<a name="l01049"></a>01049 <span class="comment">  In this file we include the just created header file and the EGS_Input</span>
<a name="l01050"></a>01050 <span class="comment">  class header file to get access to its definition,</span>
<a name="l01051"></a>01051 <span class="comment">  needed in the \c %createGeometry() function (see below):</span>
<a name="l01052"></a>01052 <span class="comment">  \until egs_input</span>
<a name="l01053"></a>01053 <span class="comment">  We also need the declarations of the various geometry classes that we</span>
<a name="l01054"></a>01054 <span class="comment">  will use to construct our geometry:</span>
<a name="l01055"></a>01055 <span class="comment">  \until egs_envelope_geometry.h</span>
<a name="l01056"></a>01056 <span class="comment">  We then define the dimensions of the various geometrical structures</span>
<a name="l01057"></a>01057 <span class="comment">  \until box_size</span>
<a name="l01058"></a>01058 <span class="comment"></span>
<a name="l01059"></a>01059 <span class="comment">  The remaining task is to implement a C-style \c %createGeometry() function</span>
<a name="l01060"></a>01060 <span class="comment">  exported by the DSO</span>
<a name="l01061"></a>01061 <span class="comment">  \until EGS_EXAMPLE1_EXPORT</span>
<a name="l01062"></a>01062 <span class="comment">  We check that the input object is valid and return \c null if it is not</span>
<a name="l01063"></a>01063 <span class="comment">  \until }</span>
<a name="l01064"></a>01064 <span class="comment">  We then look for a definition of the cylinder medium and print a warning if</span>
<a name="l01065"></a>01065 <span class="comment">  such a definition is missing:</span>
<a name="l01066"></a>01066 <span class="comment">  \skipline cyl_medium</span>
<a name="l01067"></a>01067 <span class="comment">  \until }</span>
<a name="l01068"></a>01068 <span class="comment">  We repeat basically the same code to obtain the sphere and the box</span>
<a name="l01069"></a>01069 <span class="comment">  media</span>
<a name="l01070"></a>01070 <span class="comment">  \until }</span>
<a name="l01071"></a>01071 <span class="comment">  \until }</span>
<a name="l01072"></a>01072 <span class="comment">  and return \c null if any of the media definition was missing:</span>
<a name="l01073"></a>01073 <span class="comment">  \until if</span>
<a name="l01074"></a>01074 <span class="comment">  Now we are ready to construct our geometry. We first create a set of</span>
<a name="l01075"></a>01075 <span class="comment">  parallel z-planes</span>
<a name="l01076"></a>01076 <span class="comment">  \until EGS_ZProjector</span>
<a name="l01077"></a>01077 <span class="comment">  As the planes will only be used by our geometry object internally, we don&#39;t</span>
<a name="l01078"></a>01078 <span class="comment">  care how the plane set is named and therefore give it a name using</span>
<a name="l01079"></a>01079 <span class="comment">  the static function EGS_BaseGeometry::getUniqueName().</span>
<a name="l01080"></a>01080 <span class="comment">  In a similar way we create a set of z-cylinders consisting of a single</span>
<a name="l01081"></a>01081 <span class="comment">  cylinder</span>
<a name="l01082"></a>01082 <span class="comment">  \until ZProjector</span>
<a name="l01083"></a>01083 <span class="comment">  and make a closed cylinder modeled as a 2D-geometry from the planes and the</span>
<a name="l01084"></a>01084 <span class="comment">  cylinder surface:</span>
<a name="l01085"></a>01085 <span class="comment">  \until getUniqueName</span>
<a name="l01086"></a>01086 <span class="comment">  We then set the medium of the cylinder</span>
<a name="l01087"></a>01087 <span class="comment">  \until setMedium</span>
<a name="l01088"></a>01088 <span class="comment">  The next step is to create the sphere as a set of spheres consisting of</span>
<a name="l01089"></a>01089 <span class="comment">  a single sphere</span>
<a name="l01090"></a>01090 <span class="comment">  \until getUniqueName</span>
<a name="l01091"></a>01091 <span class="comment">  and to fill it with the sphere medium defined in the input</span>
<a name="l01092"></a>01092 <span class="comment">  \until setMedium</span>
<a name="l01093"></a>01093 <span class="comment">  We then use an envelope geometry to inscribe the cylinder into the just</span>
<a name="l01094"></a>01094 <span class="comment">  created sphere:</span>
<a name="l01095"></a>01095 <span class="comment">  \until getUniqueName</span>
<a name="l01096"></a>01096 <span class="comment">  The next step is to create the outer box and fill it with the box medium</span>
<a name="l01097"></a>01097 <span class="comment">  defined in the input</span>
<a name="l01098"></a>01098 <span class="comment">  \until setMedium</span>
<a name="l01099"></a>01099 <span class="comment">  (as our geometry will always be centered about the origin, we pass a</span>
<a name="l01100"></a>01100 <span class="comment">   \c null affine transformation to the constructor of the box).</span>
<a name="l01101"></a>01101 <span class="comment">  We now inscribe the \c the_sphere geometry object (which is the sphere</span>
<a name="l01102"></a>01102 <span class="comment">  with the cylinder inscribed in it) into the just created box using</span>
<a name="l01103"></a>01103 <span class="comment">  again an envelope geometry,</span>
<a name="l01104"></a>01104 <span class="comment">  \until the_box</span>
<a name="l01105"></a>01105 <span class="comment">  set the name of \c the_box from the input using the inherited</span>
<a name="l01106"></a>01106 <span class="comment">  \link EGS_BaseGeometry::setName(EGS_Input*) setName() \endlink method,</span>
<a name="l01107"></a>01107 <span class="comment">  \until setName</span>
<a name="l01108"></a>01108 <span class="comment">  and return a pointer to the just created geometry</span>
<a name="l01109"></a>01109 <span class="comment">  \until }</span>
<a name="l01110"></a>01110 <span class="comment">  \until }</span>
<a name="l01111"></a>01111 <span class="comment">  That&#39;s all.</span>
<a name="l01112"></a>01112 <span class="comment"></span>
<a name="l01113"></a>01113 <span class="comment">  In the Makefile we include the egspp make config files,</span>
<a name="l01114"></a>01114 <span class="comment">  \dontinclude geometry/example1/Makefile</span>
<a name="l01115"></a>01115 <span class="comment">  \skipline EGS_CONFIG</span>
<a name="l01116"></a>01116 <span class="comment">  \until my_machine</span>
<a name="l01117"></a>01117 <span class="comment">  set the C-preprocessor defines to the standard set of defines</span>
<a name="l01118"></a>01118 <span class="comment">  for our egspp configuration,</span>
<a name="l01119"></a>01119 <span class="comment">  \until DEFS</span>
<a name="l01120"></a>01120 <span class="comment">  define the name of our DSO,</span>
<a name="l01121"></a>01121 <span class="comment">  \until library</span>
<a name="l01122"></a>01122 <span class="comment">  and and the set of files needed to build the DSO</span>
<a name="l01123"></a>01123 <span class="comment">  \until lib_files</span>
<a name="l01124"></a>01124 <span class="comment">  Because we are using planes, cylinders, spheres, a ND-geometry, a box</span>
<a name="l01125"></a>01125 <span class="comment">  geometry and an envelope geometry to construct our geometry, we must</span>
<a name="l01126"></a>01126 <span class="comment">  link against the geometry libraries containing these geometries.</span>
<a name="l01127"></a>01127 <span class="comment">  We accomplish this by seting the \c link2_libs make variable to the</span>
<a name="l01128"></a>01128 <span class="comment">  list of needed libraries</span>
<a name="l01129"></a>01129 <span class="comment">  \until egs_genvelope</span>
<a name="l01130"></a>01130 <span class="comment">  We then include the standard rules for building a DSO</span>
<a name="l01131"></a>01131 <span class="comment">  \until include</span>
<a name="l01132"></a>01132 <span class="comment">  and set the dependencies of our object files</span>
<a name="l01133"></a>01133 <span class="comment">  \until make_depend</span>
<a name="l01134"></a>01134 <span class="comment">  We must also add the dependencies on the various geometry header files</span>
<a name="l01135"></a>01135 <span class="comment">  that we are including</span>
<a name="l01136"></a>01136 <span class="comment">  \until egs_envelope_geometry.h</span>
<a name="l01137"></a>01137 <span class="comment">  We can now build our geometry DSO by typing \c make and use</span>
<a name="l01138"></a>01138 <span class="comment">  it by including input like this in the input file</span>
<a name="l01139"></a>01139 <span class="comment">  \verbatim</span>
<a name="l01140"></a>01140 <span class="comment">  :start geometry:</span>
<a name="l01141"></a>01141 <span class="comment">      library = geometry_example1</span>
<a name="l01142"></a>01142 <span class="comment">      name = some_name</span>
<a name="l01143"></a>01143 <span class="comment">      cylinder medium = H2O521ICRU</span>
<a name="l01144"></a>01144 <span class="comment">      sphere medium = AL521ICRU</span>
<a name="l01145"></a>01145 <span class="comment">      box medium = AIR521ICRU</span>
<a name="l01146"></a>01146 <span class="comment">  :stop geometry:</span>
<a name="l01147"></a>01147 <span class="comment">  \endverbatim</span>
<a name="l01148"></a>01148 <span class="comment">  It is worth noting that we could have constructed this geometry as the</span>
<a name="l01149"></a>01149 <span class="comment">  \link EGS_UnionGeometry union \endlink of the cylinder pointed to</span>
<a name="l01150"></a>01150 <span class="comment">  by \c the_cyl, the sphere pointed to by \c sphere and the</span>
<a name="l01151"></a>01151 <span class="comment">  box pointed to by \c box. However, such an implementation would be</span>
<a name="l01152"></a>01152 <span class="comment">  much slower at run time because for each invocation of a geometry</span>
<a name="l01153"></a>01153 <span class="comment">  method the union will have to interogate the geometry methods of all</span>
<a name="l01154"></a>01154 <span class="comment">  3 objects. In contrast, the envelope geometry will be checking only</span>
<a name="l01155"></a>01155 <span class="comment">  against the box for points outside of the box, the box and the sphere for</span>
<a name="l01156"></a>01156 <span class="comment">  points inside the box but outside the sphere, the sphere and the cylinder</span>
<a name="l01157"></a>01157 <span class="comment">  for points inside the sphere but outside the cylinder and the cylinder</span>
<a name="l01158"></a>01158 <span class="comment">  only for points inside the cylinder.</span>
<a name="l01159"></a>01159 <span class="comment"></span>
<a name="l01160"></a>01160 <span class="comment">  The complete source code of this example geometry is below</span>
<a name="l01161"></a>01161 <span class="comment">  \include geometry/example1/Makefile</span>
<a name="l01162"></a>01162 <span class="comment">  \include geometry/example1/geometry_example1.h</span>
<a name="l01163"></a>01163 <span class="comment"></span>
<a name="l01164"></a>01164 <span class="comment">*/</span>
<a name="l01165"></a>01165 
<a name="l01166"></a>01166 <span class="comment">/* \example geometry/example2/geometry_example2.cpp</span>
<a name="l01167"></a>01167 <span class="comment"></span>
<a name="l01168"></a>01168 <span class="comment">  This example illustrates how to create the same geometry as</span>
<a name="l01169"></a>01169 <span class="comment">  described in</span>
<a name="l01170"></a>01170 <span class="comment">  &lt;a href=&quot;geometry_2example1_2geometry__example1_8cpp-example.html&quot;&gt;</span>
<a name="l01171"></a>01171 <span class="comment">  this example&lt;/a&gt; but using EGS_BaseGeometry::createSingleGeometry</span>
<a name="l01172"></a>01172 <span class="comment">  to create the geometry from definitions stored in an EGS_Input objects.</span>
<a name="l01173"></a>01173 <span class="comment">  The header file is similar as in the previous</span>
<a name="l01174"></a>01174 <span class="comment">  &lt;a href=&quot;geometry_2example1_2geometry__example1_8cpp-example.html&quot;&gt;</span>
<a name="l01175"></a>01175 <span class="comment">  example&lt;/a&gt;, but unlike in the previous example we don&#39;t need the</span>
<a name="l01176"></a>01176 <span class="comment">  header files of the various geometries being used.</span>
<a name="l01177"></a>01177 <span class="comment">  Our implementation consists of a single C-style function</span>
<a name="l01178"></a>01178 <span class="comment">  \c %createGeometry()</span>
<a name="l01179"></a>01179 <span class="comment">  \dontinclude geometry/example2/geometry_example2.cpp</span>
<a name="l01180"></a>01180 <span class="comment">  \skipline createGeometry</span>
<a name="l01181"></a>01181 <span class="comment">  As with the previous</span>
<a name="l01182"></a>01182 <span class="comment">  &lt;a href=&quot;geometry_2example1_2geometry__example1_8cpp-example.html&quot;&gt;</span>
<a name="l01183"></a>01183 <span class="comment">  example&lt;/a&gt;, we check for valid input and extract the</span>
<a name="l01184"></a>01184 <span class="comment">  media of the cylinder, sphere and the box from the input</span>
<a name="l01185"></a>01185 <span class="comment">  \until !ok</span>
<a name="l01186"></a>01186 <span class="comment">  We will create the various geometry objects needed in our composite</span>
<a name="l01187"></a>01187 <span class="comment">  geometry by passing EGS_Input objects containing geometry definitions</span>
<a name="l01188"></a>01188 <span class="comment">  to the EGS_BaseGeometry::createSingleGeometry function.</span>
<a name="l01189"></a>01189 <span class="comment">  We start with the set of planes needed to close the cylinder.</span>
<a name="l01190"></a>01190 <span class="comment">  We first create an EGS_Input object named \c geometry that we will</span>
<a name="l01191"></a>01191 <span class="comment">  be passing to the geometry creation function:</span>
<a name="l01192"></a>01192 <span class="comment">  \until plane_input</span>
<a name="l01193"></a>01193 <span class="comment">  We then create properties for the library name,</span>
<a name="l01194"></a>01194 <span class="comment">  \until plane_library</span>
<a name="l01195"></a>01195 <span class="comment">  the plane-set type,</span>
<a name="l01196"></a>01196 <span class="comment">  \until plane_type</span>
<a name="l01197"></a>01197 <span class="comment">  the name of the set of planes,</span>
<a name="l01198"></a>01198 <span class="comment">  \until plane_name</span>
<a name="l01199"></a>01199 <span class="comment">  and the plane positions</span>
<a name="l01200"></a>01200 <span class="comment">  \until plane_positions</span>
<a name="l01201"></a>01201 <span class="comment">  and add them to the geometry definition</span>
<a name="l01202"></a>01202 <span class="comment">  \until plane_positions</span>
<a name="l01203"></a>01203 <span class="comment">  We then create the set of planes</span>
<a name="l01204"></a>01204 <span class="comment">  \until createSingleGeometry</span>
<a name="l01205"></a>01205 <span class="comment">  The definition and creation of the set of cylinders is very similar</span>
<a name="l01206"></a>01206 <span class="comment">  \until createSingleGeometry</span>
<a name="l01207"></a>01207 <span class="comment">  We now make a closed cylinder as a 2D geometry</span>
<a name="l01208"></a>01208 <span class="comment">  \until createSingleGeometry</span>
<a name="l01209"></a>01209 <span class="comment">  and set its medium</span>
<a name="l01210"></a>01210 <span class="comment">  \until setMedium</span>
<a name="l01211"></a>01211 <span class="comment">  In a similar fashion we create the sphere, use an envelope geometry</span>
<a name="l01212"></a>01212 <span class="comment">  to inscribe the cylinder into the sphere, create a box, and use again</span>
<a name="l01213"></a>01213 <span class="comment">  an envelope to inscribe the sphere into the box. The code is not shown</span>
<a name="l01214"></a>01214 <span class="comment">  here as it is lengthy and boring but can be found at the end of this page.</span>
<a name="l01215"></a>01215 <span class="comment">  Finally we set the name of the newly created geometry \c the_box and</span>
<a name="l01216"></a>01216 <span class="comment">  return it:</span>
<a name="l01217"></a>01217 <span class="comment">  \skipline the_box-&gt;setName</span>
<a name="l01218"></a>01218 <span class="comment">  \until }</span>
<a name="l01219"></a>01219 <span class="comment">  \until }</span>
<a name="l01220"></a>01220 <span class="comment"></span>
<a name="l01221"></a>01221 <span class="comment">  The Makefile is now simpler as we don&#39;t need to link against the</span>
<a name="l01222"></a>01222 <span class="comment">  various geometry DSOs as they are loaded dynamically at run time</span>
<a name="l01223"></a>01223 <span class="comment">  by the EGS_BaseGeometry::createSingleGeometry function and</span>
<a name="l01224"></a>01224 <span class="comment">  our implementation also does not depend on the header files of the</span>
<a name="l01225"></a>01225 <span class="comment">  various geometry classes being used:</span>
<a name="l01226"></a>01226 <span class="comment">  \include geometry/example2/Makefile</span>
<a name="l01227"></a>01227 <span class="comment"></span>
<a name="l01228"></a>01228 <span class="comment">  For completeness here is the header file:</span>
<a name="l01229"></a>01229 <span class="comment">  \include geometry/example2/geometry_example2.h</span>
<a name="l01230"></a>01230 <span class="comment">  and the complete implementation:</span>
<a name="l01231"></a>01231 <span class="comment">*/</span>
<a name="l01232"></a>01232 
<a name="l01233"></a>01233 
<a name="l01234"></a>01234 <span class="preprocessor">#endif</span>
</pre></div></div>
</div>
<hr class="footer"/><address class="footer"><small>Generated by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
